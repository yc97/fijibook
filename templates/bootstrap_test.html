<!DOCTYPE html>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=1" />

<html lang="zh-CN">
<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link href="../static/css/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">
<head>
    <title>FijiBook 首页</title>
</head>

<body>
    <nav class="navbar navbar-default navbar-static-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"></button>
                <a class="navbar-brand" href="#">FijiBook</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/index">Home</a></li>
                    <li><a href="/FBAAIndex">AA记账</a></li>
                    <li><a href="/charts">账单</a></li>
                    <!--<li><a href="#contact">Contact</a></li>-->
                    <!--<li class="dropdown">-->
                        <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>-->
                        <!--<ul class="dropdown-menu">-->
                            <!--<li><a href="#">Action</a></li>-->
                            <!--<li role="separator" class="divider"></li>-->
                            <!--<li class="dropdown-header">Nav header</li>-->
                            <!--<li><a href="#">Separated link</a></li>-->
                        <!--</ul>-->
                    <!--</li>-->
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a id="user" href="#user">{{user}}</a></li>
                    <li class="active"><a href="/logout">注销</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="jumbotron" id="content" tabindex="-1">
        <div class="container">
            <!--<div class="container theme-showcase" role="main">-->
            <div class="row">
                <div class="col-md-12 col-xs-12">
                    <!--<div class="jumbotron">-->
                        <h1> 非记不可 </h1>
                        <p> 基于地理位置的记账好帮手~</p>
                    <!--</div>-->
                </div>
            </div>
            <!--</div>-->
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <form name="info" method="post" action="/index" onSubmit="return validate_form(this)">
                {% raw xsrf_form_html() %}
                <div class="form-group">
                    <div class="input-group input-group-lg">
                        <span class="input-group-addon">金额:</span>
                        <input class="form-control" type="number" step="0.01" min="0" id="money" name="money" required="required" placeholder="0.00" aria-describedby="sizing-addon1">
                    </div>
                </div>
                <!--<div class="col-md-12 col-xs-12">-->
                    <ul class="nav nav-tabs ">
                        <li id="navExpense" class="active" role="presentation">
                            <a href="#expensetypes" data-toggle="tab" name="expenses"><p>支出</p></a>
                        </li>
                        <li id="navIncome" role="presentation">
                            <a href="#incometypes" data-toggle="tab" name="income"><p>收入</p></a>
                        </li>
                    </ul>
                <!--</div>-->
                <input id="moneySelect" type="hidden" name="moneySel" value="expenses"/>

                <div id="myTabContent" class="tab-content">
                   <div class="tab-pane in active" id="expensetypes">
                       <div class="row">
                           <div class="col-md-12"><br />
                               <div class="btn-group" data-toggle="buttons">
                                    {% for k in expensebody[0:12] %}
                                        {% for k1 in k %}
                                                <div class="col-md-3 col-xs-6">
                                                    <!--<h3>-->
                                                        <label class="btn btn-default btn-group-justified">
                                                            {% if k==expensebody[0] %}
                                                            <input type="radio"  id="firstExType" name="type" value="{{k1}}" autocomplete="off" required="required" checked="checked">{{k1}}
                                                            {%else%}
                                                            <input type="radio"  name="type" value="{{k1}}" autocomplete="off" required="required">{{k1}}
                                                            {% end %}
                                                        </label>
                                                    <!--</h3>-->
                                                </div>
                                        {% end %}
                                    {% end %}
                                   <div id="moreTypes" class="collapse fade">
                                       {% for k in expensebody[12:] %}
                                        {% for k1 in k %}
                                                <div class="col-md-3 col-xs-6">
                                                    <!--<h3>-->
                                                        <label class="btn btn-default btn-group-justified">
                                                            <input type="radio"  name="type" value="{{k1}}" autocomplete="off" required="required">{{k1}}
                                                        </label>
                                                    <!--</h3>-->
                                                </div>
                                        {% end %}
                                    {% end %}
                                   </div>
                               </div>
                               <div class="col-md-12"><br />
                                   <button id="moreTypeBtn" type="button" class="btn btn-default btn-group-justified" data-toggle="collapse" data-target="#moreTypes">更多分类</button>
                               </div>
                           </div>
                        </div>
                   </div>
                   <div class="tab-pane" id="incometypes">
                        <div class="row">
                           <div class="col-md-12 "><br />
                               <div class="btn-group" data-toggle="buttons">
                                   {% for k in incomebody %}
                                        {% for k1 in k %}
                                            <div class="col-md-3 col-xs-6">
                                                <!--<h3>-->
                                                    <label class="btn btn-default btn-group-justified">
                                                        {% if k==incomebody[0] %}
                                                            <input type="radio"  id="firstIncomeType" name="type" value="{{k1}}" autocomplete="off" required="required" >{{k1}}
                                                            {%else%}
                                                            <input type="radio"  name="type" value="{{k1}}" autocomplete="off" required="required">{{k1}}
                                                        {% end %}
                                                    </label>
                                                <!--</h3>-->
                                            </div>
                                        {% end %}
                                    {% end %}
                               </div>
                           </div>
                        </div>
                   </div>
                </div>


                <br />
                <!--<div class="page-header"></div>-->
                <div class="row">
                    <div class="col-md-6 col-xs-12">
                        <div class="input-group input-group-sm">
                            <span class="input-group-addon">定位:</span>
                            <input type="hidden" id="street" name="street"  value="" >
                            <input type="text" id="inputLocation" name="inputLocation" class="form-control" placeholder="Your Location">
                        </div><!-- /input-group -->
                    </div>
                    <div class="col-md-3 col-xs-6">
                        <div class="input-group input-group-sm">
                            <span class="input-group-addon">经度:</span>
                            <input type="text" id="lng" name="lng" class="form-control" placeholder="Your Location">
                        </div><!-- /input-group -->
                    </div>
                    <div class="col-md-3 col-xs-6">
                        <div class="input-group input-group-sm">
                            <span class="input-group-addon">纬度:</span>
                            <input type="text"  id="lat" name="lat" class="form-control" placeholder="Your Location">
                        </div><!-- /input-group -->
                    </div>
                </div>
                <br />
                <div class="row">
                    <div class="col-md-12 col-xs-12">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        切换位置
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-md-6 col-xs-12">
                                            <div id="maps" style="height:300px;width:100%"></div>
                                        </div>
                                        <div class="col-md-6 col-xs-12">
                                            <div id="locationSel"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-8 col-xs-12">
                        <div class="form-group">
                            <div class="input-group input-group-lg">
                                <span class="input-group-addon">备注:</span>
                                <input class="form-control" type="text"  name="remark"  placeholder="Details！" aria-describedby="sizing-addon1">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-xs-12">
                        <input class="btn btn-lg btn-success btn-group-justified" type="submit" value="非记不可 ">
                    </div>
                </div>

            </form>
            </div>
        </div>
        <div class="row" style="display:none">
            <!--<div class="alert alert-warning" role="alert">-->
                <div class="col-md-4 col-md-12">
                    <p> 现在你有  <mark>{{recSum}}</mark>条记录! </p>
                </div>
                <div class="col-md-6 col-xs-12">
                    <p>  最新的记录的添加时间：<mark>{{newTime}}</mark>  </p>
                </div>
            <!--</div>-->
        </div>
        <div class="row">
            <div class="col-md-6 col-xs-12">
                <div class="alert alert-info" role="alert">
                    <strong>今日：</strong> 收入￥<span id="todayIn" class="badge">{{todayIn}}</span>&nbsp;&nbsp;支出￥<span id="todayOut" class="badge">{{todayOut}}</span>
                </div>
            </div>
            <div class="col-md-6 col-xs-12">
                <div class="alert alert-info" role="alert">
                    <strong>本月：</strong> 收入￥<span id="monthIn" class="badge">{{monthIn}}</span>&nbsp;&nbsp;支出￥<span id="monthOut" class="badge">{{monthOut}}</span>
                </div>
            </div>
             <!--<div class="col-md-12 col-xs-12">-->
                   <!--<div id="radarChart" style="height:400px"></div>-->
             <!--</div>-->
            <div class="col-md-4 col-xs-12">
                <span>
                    <button class="btn btn-primary" data-toggle="modal" data-target="#myModal">
                        选择日期
                    </button>
                </span>
                <span >
                    <input type="text" autocomplete="off" id="mirror_field" value="{{today}}" readonly />
                </span>
            </div>
            <div class="col-md-4 col-xs-12">
                  <ul id="nav-pills" class="nav nav-pills">
                      <li role="presentation"><a name="dateOptions" id="5">five</a></li>
                      <li role="presentation"><a name="dateOptions" id="4">four</a></li>
                      <li role="presentation"><a name="dateOptions" id="3">three</a></li>
                      <li role="presentation"><a name="dateOptions" id="2">two</a></li>
                      <li role="presentation"><a name="dateOptions" id="1">yesterday</a></li>
                      <li role="presentation" class="active"><a id="0" name="dateOptions">today</a></li>
                  </ul>
            </div>
            <div class="col-md-12 col-xs-12">
                <!-- 模态框（Modal） -->
                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                   <div class="modal-dialog">
                      <div class="modal-content">
                         <div class="modal-header">
                            <button type="button" class="close"
                               data-dismiss="modal" aria-hidden="true">
                                  &times;
                            </button>
                            <h4 class="modal-title" id="myModalLabel">
                               选择日期
                            </h4>
                         </div>
                         <div class="modal-body">
                            <form action="" class="form-horizontal"  role="form">
                            <fieldset>
                                <div class="form-group">
                                    <div class="input-group date form_date col-md-8 col-xs-12" data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                        <input id="dateSel" class="form-control" type="text" value="" readonly>
                                        <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                                        <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                    </div>
                                    <input type="hidden" id="dtp_input2" value="" /><br/>
                                </div>
                            </fieldset>
                        </form>
                         </div>
                         <div class="modal-footer">
                            <button type="button" class="btn btn-default"
                               data-dismiss="modal">关闭
                            </button>
                            <!--<button type="button" class="btn btn-primary">-->
                               <!--提交更改-->
                            <!--</button>-->
                         </div>
                      </div><!-- /.modal-content -->
                </div><!-- /.modal -->
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 col-xs-12">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead >
                            <tr >
                                {% for i in thead %}
                                    <th >{{i}}</th>
                                {% end %}
                            </tr>
                        </thead>
                            {% for j in tbody %}
                                <tbody id="recordsTb">
                                    <tr>
                                        {% for j1 in j %}
                                            <td>{{j1}}</td>
                                        {% end %}
                                        <td><a class='glyphicon glyphicon-edit' aria-hidden='true' data-toggle='modal' data-target='#recordEdit' role='button'></a></td>
                                        <td><a class='glyphicon glyphicon-trash' aria-hidden='true' role='button' onClick='javascript:delRecord(this)'></a></td>
                                    </tr>
                                </tbody>
                            {% end %}
                    </table>
                </div>
            </div>
        </div>
        <!--模态框 编辑记录-->
        <div class="modal fade" id="recordEdit" tabindex="-1" role="dialog" aria-labelledby="recordEditLabel" aria-hidden="true">
                   <div class="modal-dialog">
                      <div class="modal-content">
                         <div class="modal-header">
                            <button type="button" class="close"
                               data-dismiss="modal" aria-hidden="true">
                                  &times;
                            </button>
                            <h4 class="modal-title" id="recordEditLabel">
                               编辑记录
                            </h4>
                         </div>
                         <div class="modal-body">
                             <div class="row">
                                 <div class="col-md-4 col-xs-12">
                                    <input type="text" autocomplete="off" id="recordDate" value="{{today}}" readonly />
                                 </div>
                                 <div class="col-md-4 col-xs-12">
                                    <input type="text" autocomplete="off" id="myLocation" value="myLocation" readonly />
                                 </div>
                                  <div class="col-md-4 col-xs-12">
                                    <input type="text" autocomplete="off" id="inOrOut" value="inOrOut" readonly />
                                 </div>
                                 <br /><br />
                                 <form name="newInfo" method="post" action="#" onSubmit="return validate_editForm(this)">
                                     {% raw xsrf_form_html() %}
                                     <div class="col-md-12 col-xs-12">
                                         <div class="form-group">
                                             <div class="input-group">
                                                 <span class="input-group-addon">金额:</span>
                                                 <input class="form-control" type="number" step="0.01" id="newMoney" name="newMoney" required="required" aria-describedby="sizing-addon1">
                                             </div>
                                         </div>
                                         <input id="moneySel" type="hidden" name="moneySel" value="expenses"/>
                                     </div>
                                     <div id="expenseDw" class="col-md-3 col-xs-12">
                                        <div  class="btn-group">
                                          <button name="newExpenseType" type="button" class="btn btn-default">
                                              types
                                          </button>
                                          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <span class="caret"></span>
                                            <span class="sr-only">Toggle Dropdown</span>
                                          </button>
                                          <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                                              {% for k in expensebody %}
                                                {% for k1 in k %}
                                                <li><a onclick="javascript:dropdownSel(this)">{{k1}}</a></li>
                                                {% end %}
                                              {% end %}
                                          </ul>
                                        </div>
                                     </div>
                                     <div id="incomeDw" class="col-md-3 col-xs-12 hidden">
                                        <div class="btn-group">
                                          <button name="newIncomeType" type="button" class="btn btn-default">
                                              types
                                          </button>
                                          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <span class="caret"></span>
                                            <span class="sr-only">Toggle Dropdown</span>
                                          </button>
                                          <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                                              {% for k in incomebody %}
                                                {% for k1 in k %}
                                                <li><a onclick="javascript:dropdownSel(this)">{{k1}}</a></li>
                                                {% end %}
                                              {% end %}
                                          </ul>
                                        </div>
                                     </div>
                                     <div class="col-md-9 col-xs-12">
                                         <div class="form-group">
                                             <div class="input-group">
                                                 <span class="input-group-addon">备注:</span>
                                                 <input class="form-control" type="text"  id="newRemark" name="newRemark"  placeholder="Details！" aria-describedby="sizing-addon1">
                                             </div>
                                         </div>
                                     </div>
                                 </form>
                             </div>
                         </div>
                         <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                取消
                            </button>
                            <button id="saveEdit" type="button" class="btn btn-primary" data-dismiss="modal">
                               保存
                            </button>
                         </div>
                      </div><!-- /.modal-content -->
                </div><!-- /.modal -->
        </div>
        <br />
        <hr />
        <footer>
            <p>© FijiBook 2016</p>
        </footer>
</div>

<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../static/js/bootstrap-datetimepicker.min.js" charset="UTF-8"></script>
<script type="text/javascript" src="../static/js/locales/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script>
<!--<script src="http://echarts.baidu.com/build/dist/echarts-all.js"></script>-->
</body>

</html>

<script type="text/javascript">
  $(document).ready(function(){
    var user=$("a#user").text();
    var strToday=$('#mirror_field').val();
    var dateToday = new Date(strToday);
    //today=myDate.toLocaleDateString();
    //console.info("today:",dateToday);

    //初始化日期导航条
    options=$("[name='dateOptions']");
    var i=options.length;
    options.each(function(){
        i--;
        var dd=GetSomeDate(i);
        $(this).html(dd.getDate());
    });

    //获取某天的日期
    function GetSomeDate(AddDayCount) {
        var dd = new Date(strToday);
        dd.setDate(dd.getDate()-AddDayCount);//获取AddDayCount天前的日期
        //var y = dd.getFullYear();
        //var m = dd.getMonth()+1;//获取当前月份的日期
       // var d = dd.getDate();
        //return y+"-"+m+"-"+d;
        return dd;
    }

    //初始化日期选择器
    $('.form_date').datetimepicker({
        format: "yyyy-mm-dd",
        language:  'zh-CN',
        weekStart: 1,
        //todayBtn:  1,
		autoclose: 1,
		todayHighlight: 1,
		startView: 2,
		minView: 2,
		forceParse: 0,
		endDate: strToday,
		pickerPosition: "bottom-left",
		linkField: "mirror_field",
        linkFormat: "yyyy-mm-dd"
    });

    //日期选择器日期change事件函数
    $('.form_date').datetimepicker().on('changeDate', function(ev){
        $('#nav-pills > li').removeClass('active');//取消全部active
        getRemoteRecord();
    });

    //日期导航条点击事件触发函数
    $("[name='dateOptions']").click(function(){
        $('#nav-pills > li').removeClass('active');//取消全部active
        $(this).parent().addClass('active');//当前点击设为active
        var agoNum=parseInt($(this).attr("id"));
        var dd=GetSomeDate(agoNum);//获取当前选择的日期
        var y = dd.getFullYear();//获取年份
        var m = dd.getMonth()+1;//获取当前的月份，0-11代表1-12所以+1
        var d = dd.getDate();//获取几号
        strdate=y+"-"+m+"-"+d;
        $('#mirror_field').val(strdate);
        $("input#dateSel").val(strdate);
        getRemoteRecord();
        });

    //编辑记录模态框事件
   $(function () { $('#recordEdit').on('show.bs.modal', function (event) {
      var target=event.relatedTarget;
      var tdSel=$(target).parent();
      var trSel=$(tdSel).parent();
      var allTd=$(trSel).children();
      var timeSel=allTd['0'].innerHTML;
      var myLocation=allTd['1'].innerHTML;
      var money=allTd['2'].innerHTML;
      var type=allTd['3'].innerHTML;
      var detail=allTd['4'].innerHTML;
      //console.info(allTd['0'].innerHTML);
      //console.info(trSel.text());
      var tmp = $('#mirror_field').val();
      tmp += (" "+timeSel);
      $('#recordDate').val(tmp);
      $('#myLocation').val(myLocation);
      if(parseFloat(money)<0)
        {
            $('#inOrOut').val('支出');
            $('#expenseDw').removeClass();
            $('#expenseDw').addClass("col-md-3 col-xs-12");
            $('#incomeDw').removeClass();
            $('#incomeDw').addClass("col-md-3 col-xs-12 hidden");
            $('[name=newExpenseType]').text(type);
            money=-money;
        }
      else
        {
            $('#inOrOut').val('收入');
            $('#expenseDw').removeClass();
            $('#expenseDw').addClass("col-md-3 col-xs-12 hidden");
            $('#incomeDw').removeClass();
            $('#incomeDw').addClass("col-md-3 col-xs-12");
            $('[name=newIncomeType]').text(type);
        }
      $('#newMoney').val(money);
      $('#newRemark').val(detail);
      })
   });

    //保存修改按钮点击
   $('#saveEdit').click(function(){
        updateRemoteRecord();
   });

   //$('.glyphicon-trash').click(function(){alert('hello')});

    //发出post请求，更新记录
    function updateRemoteRecord(){
        var time= $('#recordDate').val();
        var money=$('#newMoney').val();
        var remark=$('#newRemark').val();
        if($('#inOrOut').val()=='支出')
        {
            $('#moneySel').val('expenses');
            var type=$('[name=newExpenseType]').text();
        }
        else if ($('#inOrOut').val()=='收入')
        {
            $('#moneySel').val('income');
            var type=$('[name=newIncomeType]').text();
        }
        var moneySel=$('#moneySel').val();
        data={
            time:time,
            money:money,
            remark:remark,
            type:type,
            moneySel:moneySel
            }
        //data._xsrf = getCookie("_xsrf");

        $.post('/record',data,function(){getRemoteRecord();});
    }

    //通过名字获取cookie
   // function getCookie(name) {
      //  var c = document.cookie.match("\\b" + name + "=([^;]*)\\b");
   //  //   return c ? c[1] : undefined;
   // }
  });
</script>

<script type="text/javascript">
    function validate_required(field,alerttxt)
    {
    with (field)
      {
      if (value==null||value=="")
        {alert(alerttxt);return false}
      else {return true}
      }
    }

    function validate_form(thisform)
    {
    with (thisform)
      {
      if (validate_required(money,"请输入金额!")==false)
        {money.focus();return false}
      }
    }

    function validate_editForm(thisform)
    {
    with (thisform)
      {
      if (validate_required(newMoney,"请输入金额!")==false)
        {newMoney.focus();return false}
      }
    }


   $(function(){
      $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
          // 获取已激活的标签页的名称
          var activeTabName = $(e.target).attr("name");
          //console.info(activeTabName);
          document.getElementById("moneySelect").value = activeTabName;

          if (activeTabName =="income")
            {document.getElementById("firstIncomeType").checked=true;}
          else if (activeTabName =="expenses")
            {document.getElementById("firstExType").checked=true;}
      });

       $('#moreTypes').on('shown.bs.collapse', function () {
         document.getElementById("moreTypeBtn").innerHTML = "收起";})

       $('#moreTypes').on('hidden.bs.collapse', function () {
         document.getElementById("moreTypeBtn").innerHTML = "更多分类";})
   });



   //删除按钮点击
    function delRecord(object)
    {
        var choice=confirm("您确认要删除该记录吗？");
        if(choice){
        var user=$("a#user").text();
        var tdSel=$(object).parent();
        var trSel=$(tdSel).parent();
        var allTd=$(trSel).children();
        var time=allTd['0'].innerHTML;
        var date=$('#mirror_field').val();
        var dateTime=date+' '+time;
        data={time:dateTime};
        $.ajax({
          type: 'DELETE',
          url: '/record?time='+dateTime,
          data: data,
          success: function(){getRemoteRecord();},
          //dataType: 'json',
          //error:console.info(data)
        });
        }
    }
        //通过名字获取cookie
    //function getCookie(name) {
     //   var c = document.cookie.match("\\b" + name + "=([^;]*)\\b");
      //  return c ? c[1] : undefined;
    //}

    function getRemoteRecord(){
        $("#recordsTb tr").remove();
        //var user=$("a#user").text();
       // console.info("user:",user);
        strdate = $("#mirror_field").val();
        //console.info("strdate:",strdate);
        $.getJSON("/record",{myDate:strdate},function(records){
            $.each(records,function(i,record){
                //poiTmp=record['1'].split(',');
                //poi=poiTmp[poiTmp.length-1];
                var newRow = "<tr><td>"+record['0']+"</td><td>"+record['1']+"</td><td>"+record['2']+"</td><td>"+record['3']+"</td><td>"+record['4'];
                newRow+="</td><td><a class='glyphicon glyphicon-edit' aria-hidden='true' data-toggle='modal' data-target='#recordEdit' role='button'></a></td>";
                newRow+="<td><a class='glyphicon glyphicon-trash' aria-hidden='true' role='button' onClick='javascript:delRecord(this)'></a></td></tr>";
                //newRow+="<td><a class='glyphicon glyphicon-trash' aria-hidden='true' role='button'></a></td></tr>";
                $("#recordsTb").append(newRow);
            });
        });
    }

    function dropdownSel(object)
    {
        if($('#inOrOut').val()=='支出')
        {
             $('[name=newExpenseType]').text($(object).text());
        }
        else if ($('#inOrOut').val()=='收入')
        {
             $('[name=newIncomeType]').text($(object).text());
        }
    }
</script>
<script src="../static/js/ajax-setup.js"></script>
<!--地图相关js  异步加载-->
<script src="../static/js/map.js"></script>



